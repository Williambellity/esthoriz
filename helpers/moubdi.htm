<html>
    <head>
        <script src="easycanvas.js"></script>
        <script>
            var ctx;
            var particle_size = 500;
            var particles = [];
            
            var band = 5;
            
            window.onload = function(){
                ctx = new canvasManager("canvas");
                ctx.resize(600,500);
                
                generate_part()
                
                coreLoop();
            }
            
            function generate_part(){
                for(let i=0;i<particle_size;i++){
                    particles.push(new particle(ctx.w,ctx.h));
                }
            }
            
            function particle(w,h){
                this.x = Math.round(w*Math.random());
                this.y = Math.round(h*Math.random());
                this.col = "black";
                if(this.y>ctx.h/2){
                    this.col = "blue";
                }
            }
            
            particle.prototype.display = function(){
                ctx.save();
                
                ctx.ctx.fillStyle = this.col;
                
                ctx.beginPath();
                ctx.moveTo(this.x,this.y);
                ctx.arc(this.x,this.y,2,0,2*Math.PI,false);
                ctx.fill();
                ctx.closePath();
                ctx.restore();
            }
            
            particle.prototype.move = function(){
                // move x
                p = Math.random()
                v = 1;
                if(this.y<(ctx.h+band)/2 && this.y>(ctx.h-band)/2){
                    v = 2;
                }
                if(p<1/2){
                    this.x+=v
                }
                else{
                    this.x-=v;
                }
                
                p = Math.random()
                
                if(p<1/2){
                    this.y+=v
                }
                else{
                    this.y-=v;
                }
                
                if(this.y<5 ||this.y>ctx.h-5){
                    let ind = particles.indexOf(this);
                    particles.splice(ind,1);
                }
            }
            
            function coreLoop(){
                
                // move particles
                ctx.clearRect(0,0,1000,1000);
                for(let part of particles){
                    part.move();
                    part.display();
                }
                // draw band;
                ctx.save();
                ctx.ctx.fillStyle = "green";
                ctx.fillRect(0,(ctx.h-band)/2,ctx.w,band);
                ctx.ctx.fillStyle = "red";
                
                ctx.fillRect(0,0,ctx.w,5);
                ctx.fillRect(0,ctx.h-5,ctx.w,5);
                ctx.restore();
                
                
                requestAnimationFrame(coreLoop);
            }
        </script>
    </head>
    <body>
        <canvas></canvas>
    </body>
</html>